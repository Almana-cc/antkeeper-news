# Ralph Progress Log

This file tracks learnings and progress across iterations.
Each iteration appends new entries - NEVER delete or replace existing content.

---


## Iteration 1 - 2026-01-11T12:00:00Z
### Completed: US-001 - Fix related articles showing duplicates
### Implementation:
- Modified `server/api/articles/[slug]/related.get.ts`
- Added query to `articleDuplicates` table to find all duplicate relationships for the current article
- Excluded all duplicate article IDs (both canonical and duplicate) from related articles query
- Added slug-based deduplication as a safety net filter
### Learnings:
- The project uses `hub:db` for database imports, which auto-resolves to local utils
- No `typecheck` npm script - use `pnpm build` which includes type checking
- No `lint` npm script - use `pnpm eslint <file>` directly
- Branch `ralph/fixes-and-search` was checked out in another worktree, working on `ralph/amp` instead
### Next Priority: US-002

## Iteration 2 - 2026-01-11T12:30:00Z
### Completed: US-002 - Increase related articles count to 6
### Implementation:
- Modified `server/api/articles/[slug]/related.get.ts`: changed limit from 5 to 6
- Grid layout was already `sm:grid-cols-2 lg:grid-cols-3` which is perfect for 6 articles (2x3 on desktop, 3x2 on small screens)
### Learnings:
- The existing grid layout was already responsive and flexible enough to accommodate more items
- Simple changes sometimes require no UI updates if the layout is already well-designed
### Next Priority: US-003

## Iteration 3 - 2026-01-11T13:00:00Z
### Completed: US-003 - Persist filter state on language change
### Implementation:
- Added `@vueuse/core` and `@vueuse/nuxt` dependencies
- Added `@vueuse/nuxt` to nuxt.config.ts modules
- Modified `app/pages/index.vue`:
  - Added useLocalStorage for language, category, tags, and dateRange
  - URL query params take precedence, then localStorage values, then defaults
  - Added watchers to sync filter changes to localStorage
  - Created `clearFilters()` function that clears both reactive state and localStorage
  - Updated both clear filter buttons to use the new function
### Learnings:
- VueUse is not included by default in this Nuxt project - need to install both @vueuse/core and @vueuse/nuxt
- Generic arrow functions `<T>() =>` cause Vue template parsing errors, use `function` declarations instead
- Pre-existing ESLint errors (like `any` type) don't need to be fixed as part of unrelated stories
### Next Priority: US-004

## Iteration 4 - 2026-01-11T14:00:00Z
### Completed: US-004 - Remove auto language detection
### Implementation:
- Modified `nuxt.config.ts`: set `detectBrowserLanguage: false` instead of the object config
- Default language remains French (fr)
- Language preference still persists via @nuxtjs/i18n built-in cookie when user manually changes language
### Learnings:
- Setting `detectBrowserLanguage: false` completely disables browser language detection
- @nuxtjs/i18n still stores user language preference in a cookie when they manually switch, so persistence works without explicit config
- Very simple one-line change - the i18n module handles language persistence automatically
### Next Priority: US-005

## Iteration 5 - 2026-01-11T15:00:00Z
### Completed: US-005 - Scroll to top on page change
### Implementation:
- Modified `app/pages/index.vue`: added a watcher on the `page` ref
- Uses `window.scrollTo({ top: 0, behavior: 'smooth' })` for smooth animation
- Works for all pagination interactions (next/prev buttons and direct page number clicks) since all change `page.value`
### Learnings:
- Simple watch on the page ref covers all pagination cases automatically
- No need to add event handlers to pagination component - watching the model value is cleaner
- Pre-existing type errors in project don't block story completion (build passes, just strict typecheck has pre-existing issues)
### Next Priority: US-006

## Iteration 6 - 2026-01-11T16:00:00Z
### Completed: US-006 - Add click-to-filter on article tags
### Implementation:
- Modified `app/components/ArticleCard.vue`
- Added `useRouter()` and `handleTagClick(tag)` function that navigates to `{ path: '/', query: { tags: tag } }`
- Used `@click.stop.prevent` on UBadge to prevent card link navigation when clicking tags
- Added hover styling with `cursor-pointer hover:opacity-80 transition-opacity`
### Learnings:
- UBadge supports @click event handlers directly
- Using `.stop.prevent` modifiers is essential since the card itself is a link (UBlogPost with :to prop)
- Pre-existing ESLint errors (like unused getLanguageFlag) don't block story completion
### Next Priority: US-007
